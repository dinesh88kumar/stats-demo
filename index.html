<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mini E-Commerce Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Google tag (gtag.js) G-V4S503Y70N -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-R1M0DHDXJ5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-R1M0DHDXJ5');
  </script>

  <style>
    :root {
      --bg: #f8fafc;
      --card: #ffffff;
      --text: #0f172a;
      --accent: #2563eb;
    }

    body {
      margin: 0;
      padding: 30px;
      font-family: "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    h1 {
      text-align: center;
      color: var(--accent);
    }

    .container {
      max-width: 900px;
      margin: auto;
    }

    .products {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .card {
      background: var(--card);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    button {
      background: var(--accent);
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
    }

    .cart {
      margin-top: 40px;
      background: var(--card);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    input {
      padding: 8px;
      width: 220px;
      margin-right: 10px;
    }

    .success { color: green; font-weight: bold; }
    .error { color: red; font-weight: bold; }
  </style>
</head>

<body>
<div class="container">
  <h1>üõí Mini E-Commerce Store</h1>

  <!-- PRODUCTS -->
  <div class="products" id="product-list"></div>

  <!-- CART -->
  <div class="cart">
    <h2>üßæ Cart</h2>
    <ul id="cart-items"></ul>
    <p><strong>Total:</strong> ‚Çπ<span id="total">0</span></p>

    <input type="text" id="coupon" placeholder="Enter coupon code" />
    <button onclick="purchase()">Buy Now</button>

    <p id="message"></p>
  </div>
</div>

<script>
  const products = [
    { id: 1, name: "üìò JavaScript Book", price: 500 },
    { id: 2, name: "üìó Python Book", price: 600 },
    { id: 3, name: "üéß Headphones", price: 1500 },
    { id: 4, name: "‚å®Ô∏è Keyboard", price: 1200 }
  ];

  let cart = [];

  function renderProducts() {
    const list = document.getElementById("product-list");
    list.innerHTML = "";
    products.forEach(p => {
      list.innerHTML += `
        <div class="card">
          <h3>${p.name}</h3>
          <p>Price: ‚Çπ${p.price}</p>
          <button onclick="addToCart(${p.id})">Add to Cart</button>
        </div>`;
    });
  }

  function addToCart(id) {
    const product = products.find(p => p.id === id);
    cart.push(product);
    renderCart();

    gtag('event', 'add_to_cart', {
      item_name: product.name,
      price: product.price
    });
  }

  function renderCart() {
    const items = document.getElementById("cart-items");
    items.innerHTML = "";
    let total = 0;

    cart.forEach(item => {
      total += item.price;
      items.innerHTML += `<li>${item.name} - ‚Çπ${item.price}</li>`;
    });

    document.getElementById("total").textContent = total;
  }

  function purchase() {
    const code = document.getElementById("coupon").value.trim();
    let total = cart.reduce((s, i) => s + i.price, 0);
    const msg = document.getElementById("message");

    if (cart.length === 0) {
      msg.textContent = "‚ùå Cart is empty!";
      msg.className = "error";
      return;
    }

    if (code.startsWith("FREE")) {
      total = 0;
      gtag('event', 'purchase', {
        coupon: code,
        value: 0,
        currency: 'INR'
      });
      msg.textContent = "üéâ Purchase successful! Total = ‚Çπ0 (FREE coupon)";
    } else {
      gtag('event', 'purchase', {
        value: total,
        currency: 'INR'
      });
      msg.textContent = `‚úÖ Purchase successful! Paid ‚Çπ${total}`;
    }

    msg.className = "success";
    cart = [];
    renderCart();
  }

  renderProducts();
</script>
</body>
</html>
